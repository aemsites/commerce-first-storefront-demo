{"version":3,"file":"KlarnaPayments.js","sources":["../../../../src/components/Klarna/KlarnaPayments.tsx"],"sourcesContent":["import { h } from 'preact';\nimport UIElement from '../internal/UIElement/UIElement';\nimport { CoreProvider } from '../../core/Context/CoreProvider';\nimport { KlarnConfiguration } from './types';\nimport PayButton from '../internal/PayButton';\nimport { KlarnaContainer } from './components/KlarnaContainer/KlarnaContainer';\nimport { PaymentAction } from '../../types/global-types';\nimport { TxVariants } from '../tx-variants';\nimport type { ICore } from '../../core/types';\n\nclass KlarnaPayments extends UIElement<KlarnConfiguration> {\n    public static type = TxVariants.klarna;\n    public static txVariants = [TxVariants.klarna, TxVariants.klarna_account, TxVariants.klarna_paynow, TxVariants.klarna_b2b];\n\n    protected static defaultProps = {\n        useKlarnaWidget: false\n    };\n\n    constructor(checkout: ICore, props?: KlarnConfiguration) {\n        super(checkout, props);\n\n        this.onComplete = this.onComplete.bind(this);\n        this.updateWithAction = this.updateWithAction.bind(this);\n        this.submit = this.submit.bind(this);\n        this.onLoaded = this.onLoaded.bind(this);\n    }\n    get isValid() {\n        return true;\n    }\n\n    protected formatData() {\n        return {\n            paymentMethod: {\n                type: this.type,\n                ...(this.props.useKlarnaWidget ? { subtype: 'sdk' } : {})\n            }\n        };\n    }\n\n    public payButton = props => {\n        return <PayButton amount={this.props.amount} onClick={this.submit} {...props} />;\n    };\n\n    updateWithAction(action: PaymentAction): void {\n        if (action.paymentMethodType !== this.type) throw new Error('Invalid Action');\n        this.componentRef.setAction(action);\n    }\n\n    onLoaded() {\n        // When action/widget is loaded, set the 'drop-in' back to ready\n        this.setElementStatus('ready');\n    }\n\n    render() {\n        return (\n            <CoreProvider i18n={this.props.i18n} loadingContext={this.props.loadingContext} resources={this.resources}>\n                <KlarnaContainer\n                    {...this.props}\n                    ref={ref => {\n                        this.componentRef = ref;\n                    }}\n                    displayName={this.displayName}\n                    onComplete={state => this.handleAdditionalDetails(state)}\n                    onError={this.props.onError}\n                    payButton={this.payButton}\n                    onLoaded={this.onLoaded}\n                    onActionHandled={this.onActionHandled}\n                />\n            </CoreProvider>\n        );\n    }\n}\n\nexport default KlarnaPayments;\n"],"names":["KlarnaPayments","UIElement","isValid","formatData","paymentMethod","_object_spread","type","this","props","useKlarnaWidget","subtype","updateWithAction","action","paymentMethodType","Error","componentRef","setAction","onLoaded","setElementStatus","render","h","CoreProvider","i18n","loadingContext","resources","KlarnaContainer","ref","displayName","onComplete","state","handleAdditionalDetails","onError","payButton","onActionHandled","constructor","checkout","super","_define_property","PayButton","amount","onClick","submit","bind","TxVariants","klarna","txVariants","klarna_account","klarna_paynow","klarna_b2b","defaultProps"],"mappings":"wqCAUA,MAAMA,UAAuBC,EAgBzB,WAAIC,GACA,OAAO,CACX,CAEUC,UAAAA,GACN,MAAO,CACHC,cAAeC,EAAA,CACXC,KAAMC,KAAKD,MACPC,KAAKC,MAAMC,gBAAkB,CAAEC,QAAS,OAAU,IAGlE,CAMAC,gBAAAA,CAAiBC,GACb,GAAIA,EAAOC,oBAAsBN,KAAKD,KAAM,MAAM,IAAIQ,MAAM,kBAC5DP,KAAKQ,aAAaC,UAAUJ,EAChC,CAEAK,QAAAA,GAEIV,KAAKW,iBAAiB,QAC1B,CAEAC,MAAAA,GACI,OACIC,EAACC,EAAAA,CAAaC,KAAMf,KAAKC,MAAMc,KAAMC,eAAgBhB,KAAKC,MAAMe,eAAgBC,UAAWjB,KAAKiB,WAC5FJ,EAACK,EAAAA,EAAAA,EAAAA,GACOlB,KAAKC,OAAK,CACdkB,IAAKA,IACDnB,KAAKQ,aAAeW,CAAAA,EAExBC,YAAapB,KAAKoB,YAClBC,WAAYC,GAAStB,KAAKuB,wBAAwBD,GAClDE,QAASxB,KAAKC,MAAMuB,QACpBC,UAAWzB,KAAKyB,UAChBf,SAAUV,KAAKU,SACfgB,gBAAiB1B,KAAK0B,mBAItC,CApDAC,WAAAA,CAAYC,EAAiB3B,GACzB4B,MAAMD,EAAU3B,GAoBpB6B,EAAA9B,KAAOyB,aAAYxB,GACRY,EAACkB,EAAAA,EAAAA,CAAUC,OAAQhC,KAAKC,MAAM+B,OAAQC,QAASjC,KAAKkC,QAAYjC,MAnBvED,KAAKqB,WAAarB,KAAKqB,WAAWc,KAAKnC,MACvCA,KAAKI,iBAAmBJ,KAAKI,iBAAiB+B,KAAKnC,MACnDA,KAAKkC,OAASlC,KAAKkC,OAAOC,KAAKnC,MAC/BA,KAAKU,SAAWV,KAAKU,SAASyB,KAAKnC,KACvC,EAdA8B,EADErC,EACYM,OAAOqC,EAAWC,QAChCP,EAFErC,EAEY6C,aAAa,CAACF,EAAWC,OAAQD,EAAWG,eAAgBH,EAAWI,cAAeJ,EAAWK,aAE/GX,EAJErC,EAIeiD,eAAe,CAC5BxC,iBAAiB"}